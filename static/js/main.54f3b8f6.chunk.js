(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{50:function(e,t,n){e.exports=n(74)},55:function(e,t,n){},56:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(15),o=n.n(i),c=(n(55),n(27)),s=n(28),u=n(31),l=n(29),d=n(32),h=n(21),m=n(18),v=(n(56),n(87)),f=n(86),p=function(e){var t=!!window.BarcodeDetector,n=r.a.createElement("p",{className:"error"},"Your browser does not support Shape Detection API. If you are using Chrome on Android enable Experimental Web Platform features.");return r.a.createElement("div",{className:"Start"},r.a.createElement(f.a,{variant:"h3",component:"h2"},"Shape Detection API test"),!t&&n,r.a.createElement(h.b,{to:"/qr-code"},r.a.createElement(v.a,{variant:"contained",type:"button",color:"primary"},"Scan QR-Code")))},E=n(12),b=n.n(E),w=n(24),x=(n(71),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).videoElement=void 0,n.canvasContext=void 0,n.canvasElementRef=void 0,n.barcodeDetector=void 0,n.mediaStream=void 0,n.stopped=!1,n.canvasElementRef=r.a.createRef(),n.barcodeDetector=new window.BarcodeDetector,n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(w.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.createCanvasContext(),e.next=4,this.initVideo();case 4:return e.next=6,this.run();case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),alert(e.t0),this.stopped=!0;case 12:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){if(this.mediaStream){var e=!0,t=!1,n=void 0;try{for(var a,r=this.mediaStream.getTracks()[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){a.value.stop()}}catch(i){t=!0,n=i}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}this.videoElement&&this.videoElement.pause(),this.stopped=!0}},{key:"createCanvasContext",value:function(){if(null==this.canvasElementRef.current)throw new Error("Canvas not set");var e=this.canvasElementRef.current.getContext("2d");if(!e)throw new Error("Failed to create canvas context");this.canvasContext=e}},{key:"initVideo",value:function(){var e=Object(w.a)(b.a.mark(function e(){var t,n=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={video:{facingMode:"environment"}},e.next=3,navigator.mediaDevices.getUserMedia(t);case 3:this.mediaStream=e.sent,this.videoElement=document.createElement("video"),this.videoElement.srcObject=this.mediaStream,this.videoElement.autoplay=!0,this.videoElement.onloadedmetadata=function(){if(n.canvasElementRef.current&&n.videoElement){var e=n.canvasElementRef.current.offsetHeight,t=n.canvasElementRef.current.offsetWidth/e,a=n.videoElement.videoHeight*t,r=n.videoElement.videoHeight;n.canvasElementRef.current.width=a,n.canvasElementRef.current.height=r}};case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=Object(w.a)(b.a.mark(function e(){var t=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:requestAnimationFrame(function(){return t.renderVideo()});case 1:if(this.stopped){e.next=6;break}return e.next=4,this.detectBarcode();case 4:e.next=1;break;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderVideo",value:function(){var e=Object(w.a)(b.a.mark(function e(){var t,n=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canvasElementRef.current&&this.videoElement&&this.canvasContext){e.next=2;break}return e.abrupt("return");case 2:t=this.canvasElementRef.current,this.canvasContext.clearRect(0,0,t.width,t.height),this.canvasContext.drawImage(this.videoElement,(this.videoElement.videoWidth-t.width)/2,0,t.width,t.height,0,0,t.width,t.height),this.stopped||requestAnimationFrame(function(){return n.renderVideo()});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"detectBarcode",value:function(){var e=Object(w.a)(b.a.mark(function e(){var t,n,a,r,i,o,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(e){return setTimeout(e,300)});case 2:if(null!=this.videoElement&&!this.videoElement.paused){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,this.barcodeDetector.detect(this.videoElement);case 7:for(t=e.sent,n=!0,a=!1,r=void 0,e.prev=11,i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0)c=o.value,console.log("Detected barcode",c),this.props.setQrData(c.rawValue),this.props.history.push({pathname:"/result"});e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),a=!0,r=e.t0;case 19:e.prev=19,e.prev=20,n||null==i.return||i.return();case 22:if(e.prev=22,!a){e.next=25;break}throw r;case 25:return e.finish(22);case 26:return e.finish(19);case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(4),console.error("Error in detect barcode",e.t1);case 32:case"end":return e.stop()}},e,this,[[4,29],[11,15,19,27],[20,,22,26]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"ScanQrCode"},r.a.createElement("div",{className:"overlay"},r.a.createElement("div",{className:"inner"})),r.a.createElement("div",{className:"info"},r.a.createElement("span",null,"Position the QR code in the center of the screen")),r.a.createElement("canvas",{ref:this.canvasElementRef}))}}]),t}(r.a.Component)),y=(n(72),function(e){e.qrData||e.history.push({pathname:"/"});var t=/^https?:\/\//.test(e.qrData),n=r.a.createElement(v.a,{onClick:function(){window.open(e.qrData,"_blank","noopener")}},"Open URL");return r.a.createElement("div",{className:"Result"},r.a.createElement(f.a,{color:"textSecondary",gutterBottom:!0},"QR code data"),r.a.createElement(f.a,{variant:"h5",component:"h2"},e.qrData),r.a.createElement(h.b,{to:"/qr-code",className:"scan-again-link"},r.a.createElement(v.a,{variant:"contained",color:"primary"},"Scan again")),t&&n)}),k=(n(73),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={qrData:""},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"setQrData",value:function(e){this.setState({qrData:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(h.a,{basename:"/shape-detection-test"},r.a.createElement("div",{className:"App-container"},r.a.createElement(m.a,{exact:!0,path:"/",component:p}),r.a.createElement(m.a,{path:"/qr-code",render:function(t){return r.a.createElement(x,Object.assign({},t,{setQrData:function(t){return e.setQrData(t)}}))}}),r.a.createElement(m.a,{path:"/result",render:function(t){return r.a.createElement(y,Object.assign({},t,{qrData:e.state.qrData}))}})))}}]),t}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[50,1,2]]]);
//# sourceMappingURL=main.54f3b8f6.chunk.js.map